# 新手小白也能打赢 VPS 入侵战：我用 OpenClaw 48 小时完成止血、清理与加固

- 原始链接：<内部复盘改写>
- 作者：oGL2046
- 发布时间：2026-02-28
- X Article：<无>

---

很多人以为：

> VPS 被入侵 = 只能重装系统。

我也曾这么想。

直到这次，服务器被挖矿木马打爆，CPU 100%、负载飙到 10+，整机卡成 PPT。作为一个运维新手，我没有第一时间崩溃，而是让 **OpenClaw** 带着我一步步排查、止血、清理、复盘，最后把机器救了回来。

这篇是给“非安全专家”的实战版本：**不讲玄学，讲可执行路径**。

## 0. 事故现场：我怎么知道自己中招了？

最早的信号非常朴素：

- SSH 登录明显卡顿
- `top` 里负载异常（10+）
- CPU 接近 100%
- 2.4G 内存几乎吃满

如果你也遇到“业务没变，机器突然喘不过气”，第一反应别再调业务参数，**先当成安全事件处理**。

## 1. 新手最容易犯的错：先杀进程

我一开始也想直接 `kill -9`，结果发现：杀一个，起来一个。

OpenClaw 帮我定位到容器内循环脚本（典型矿工保活）：

```bash
while true; do
  /var/tmp/kworker_ds -c /var/tmp/.kworker.conf
  sleep 10
done
```

这一步让我第一次意识到：

- “CPU 100%”只是症状
- “保活机制”才是病根

## 2. 关键转折：OpenClaw 带我找到证据链

不是盲猜，而是证据驱动。

### 2.1 先锁定异常进程

```bash
docker exec docker-web-1 ps aux
```

看到这些名字就要警惕：

- `kworker_ds`（伪装内核进程）
- `kirkd`
- `x64`

### 2.2 再看恶意文件落点

```bash
docker exec docker-web-1 ls -la /var/tmp/
```

定位到：

- `kworker_ds`（UPX 打包 ELF）
- `.kworker.conf`（XMRig 配置）

配置里是矿池和钱包地址，基本实锤挖矿木马。

### 2.3 最扎心的一步：回看入侵入口

Nginx 日志出现：

```text
GET /.env 200
GET /.git/config 200
```

这两行等于一记重拳：

- `.env` 被直接访问到
- 敏感变量可能外泄
- 攻击者拿到密钥后再入容器

**结论：这不是“运气不好”，是“暴露面没收口”。**

## 3. 新手可复制的处理顺序（真的救命）

OpenClaw 给我的最大帮助，不是“替我按命令”，而是给了一个不慌的顺序：

1. **止血**：隔离异常容器
2. **清理**：重建受污染容器（别恋战）
3. **复核**：确认恶意进程归零
4. **加固**：补所有被利用入口
5. **复盘**：把“这次怎么中招”写成规则

## 4. 我最后怎么处理的（低风险版本）

### 4.1 重建容器，而不是原地修补

```bash
docker stop docker-web-1
docker rm docker-web-1
docker compose up -d
```

为什么这个方案适合新手：

- 操作简单
- 回滚清晰
- 不会和恶意保活脚本缠斗

### 4.2 立刻做 5 个加固动作

1. SSH 改为密钥认证，禁用密码登录
2. Nginx 拒绝访问 `.env` 和 `.git`
3. 给关键容器加内存上限（防止再被吃光）
4. 系统补丁升级 + 重启
5. 清理废弃镜像和异常日志

## 5. 结果：机器从“快死了”回到可用

清理后我的机器状态：

- 负载从 10+ 回落到 1 以下
- 内存占用回到健康区间
- 恶意进程：0
- 业务容器恢复正常

这不是“安全大神时刻”，只是一次按流程执行的事故处理。

## 6. 给推友的 6 条最小安全清单（建议收藏）

### 1）把 `.env` / `.git` 永久拦住

```nginx
location ~ /\.env$ { deny all; }
location ~ /\.git/ { deny all; }
```

### 2）不要把密码登录当默认选项

SSH 用密钥登录，`PasswordAuthentication no`。

### 3）容器要有资源上限

不然一个木马就能拖死整机。

### 4）异常负载默认按安全事件处理

先排安全，再排性能。

### 5）定期清理镜像和日志

减少攻击面，也降低排查噪音。

### 6）复盘文档要写

下一次救你的，不是记忆，是你这次写下来的 SOP。

## 7. 为什么我建议新手把 OpenClaw 当“应急搭子”

因为事故里最贵的不是算力，是决策。

人在慌的时候，最容易：

- 跳步骤
- 误删证据
- 修了表面没修根因

OpenClaw 的价值就是把你从“恐慌反应”拉回“流程执行”。

它不保证你永不被打，但能显著提高你“被打后恢复”的速度和质量。

## 8. 最后一句

如果你现在也在跑 VPS + Docker，今天就做两件事：

- 检查 `.env` 有没有暴露
- 给 SSH 改成密钥登录

你可能会因此少一次彻夜事故。

---

**#OpenClaw #VPS安全 #Docker运维 #挖矿木马 #新手运维 #IncidentResponse**
